/*
 * --------------------------------------------------------------------
 * jQuery-Plugin - selectToUISlider - creates a UI slider component from a select element(s)
 * by Scott Jehl, scott@filamentgroup.com
 * http://www.filamentgroup.com
 * reference article: http://www.filamentgroup.com/lab/update_jquery_ui_16_slider_from_a_select_element/
 * demo page: http://www.filamentgroup.com/examples/slider_v2/index.html
 * 
 * Copyright (c) 2008 Filament Group, Inc
 * Dual licensed under the MIT (filamentgroup.com/examples/mit-license.txt) and GPL (filamentgroup.com/examples/gpl-license.txt) licenses.
 *
 * Usage Notes: please refer to our article above for documentation
 *  
 * --------------------------------------------------------------------
 */
jQuery.fn.selectToUISlider=function(e){function o(e){return e.constructor==Array}function u(e){return n.tooltipSrc=="text"?i[e].text:i[e].value}function h(e){return(e/(i.length-1)*100).toFixed(2)+"%"}var t=jQuery(this),n=jQuery.extend({labels:3,tooltip:!0,tooltipSrc:"text",labelSrc:"value",sliderOptions:null},e),r=function(){var e=[];return t.each(function(){e.push("handle_"+jQuery(this).attr("id"))}),e}(),i=function(){var e=[];return t.eq(0).find("option").each(function(){e.push({value:jQuery(this).attr("value"),text:jQuery(this).text()})}),e}(),s=function(){if(t.eq(0).find("optgroup").size()>0){var e=[];return t.eq(0).find("optgroup").each(function(t){e[t]={},e[t].label=jQuery(this).attr("label"),e[t].options=[],jQuery(this).find("option").each(function(){e[t].options.push({text:jQuery(this).text(),value:jQuery(this).attr("value")})})}),e}return null}(),a={step:1,min:0,orientation:"horizontal",max:i.length-1,range:t.length>1,slide:function(e,t){var n=jQuery(t.handle),r=u(t.value);n.attr("aria-valuetext",r).attr("aria-valuenow",t.value).find(".ui-slider-tooltip .ttContent").text(r);var i=jQuery("#"+n.attr("id").split("handle_")[1]);i.find("option").eq(t.value).attr("selected","selected")},values:function(){var e=[];return t.each(function(){e.push(jQuery(this).get(0).selectedIndex)}),e}()};n.sliderOptions=e?jQuery.extend(a,e.sliderOptions):a,t.bind("change keyup click",function(){var e=jQuery(this).get(0).selectedIndex,t=jQuery("#handle_"+jQuery(this).attr("id")),n=t.data("handleNum");t.parents(".ui-slider:eq(0)").slider("values",n,e)});var f=jQuery("<div></div>");t.each(function(e){var t="",i=jQuery("label[for="+jQuery(this).attr("id")+"]"),s=i.size()>0?"Slider control for "+i.text()+"":"",o=i.attr("id")||i.attr("id","label_"+r[e]).attr("id");n.tooltip==0&&(t=' style="display: none;"'),jQuery('<a href="#" tabindex="0" id="'+r[e]+'" '+'class="ui-slider-handle" '+'role="slider" '+'aria-labelledby="'+o+'" '+'aria-valuemin="'+n.sliderOptions.min+'" '+'aria-valuemax="'+n.sliderOptions.max+'" '+'aria-valuenow="'+n.sliderOptions.values[e]+'" '+'aria-valuetext="'+u(n.sliderOptions.values[e])+'" '+'><span class="screenReaderContext">'+s+"</span>"+'<span class="ui-slider-tooltip ui-widget-content ui-corner-all"'+t+'><span class="ttContent"></span>'+'<span class="ui-tooltip-pointer-down ui-widget-content"><span class="ui-tooltip-pointer-down-inner"></span></span>'+"</span></a>").data("handleNum",e).appendTo(f)});if(s){var l=0,c=f.append('<dl class="ui-slider-scale ui-helper-reset" role="presentation"></dl>').find(".ui-slider-scale:eq(0)");jQuery(s).each(function(e){c.append('<dt style="width: '+(100/s.length).toFixed(2)+"%"+"; left:"+(e/(s.length-1)*100).toFixed(2)+"%"+'"><span>'+this.label+"</span></dt>");var t=this.options;jQuery(this.options).each(function(e){var r=l==i.length-1||l==0?'style="display: none;"':"",s=n.labelSrc=="text"?t[e].text:t[e].value;c.append('<dd style="left:'+h(l)+'"><span class="ui-slider-label">'+s+'</span><span class="ui-slider-tic ui-widget-content"'+r+"></span></dd>"),l++})})}else{var c=f.append('<ol class="ui-slider-scale ui-helper-reset" role="presentation"></ol>').find(".ui-slider-scale:eq(0)");jQuery(i).each(function(e){var t=e==i.length-1||e==0?'style="display: none;"':"",r=n.labelSrc=="text"?this.text:this.value;c.append('<li style="left:'+h(e)+'"><span class="ui-slider-label">'+r+'</span><span class="ui-slider-tic ui-widget-content"'+t+"></span></li>")})}n.labels>1&&f.find(".ui-slider-scale li:last span.ui-slider-label, .ui-slider-scale dd:last span.ui-slider-label").addClass("ui-slider-label-show");var p=Math.max(1,Math.round(i.length/n.labels));for(var d=0;d<i.length;d+=p)i.length-d>p&&f.find(".ui-slider-scale li:eq("+d+") span.ui-slider-label, .ui-slider-scale dd:eq("+d+") span.ui-slider-label").addClass("ui-slider-label-show");f.find(".ui-slider-scale dt").each(function(e){jQuery(this).css({left:(100/s.length*e).toFixed(2)+"%"})}),f.insertAfter(jQuery(this).eq(this.length-1)).slider(n.sliderOptions).attr("role","application").find(".ui-slider-label").each(function(){jQuery(this).css("marginLeft",-jQuery(this).width()/2)}),f.find(".ui-tooltip-pointer-down-inner").each(function(){var e=jQuery(".ui-tooltip-pointer-down-inner").css("borderTopWidth"),t=jQuery(this).parents(".ui-slider-tooltip").css("backgroundColor");jQuery(this).css("border-top",e+" solid "+t)});var v=f.slider("values");return o(v)?jQuery(v).each(function(e){f.find(".ui-slider-tooltip .ttContent").eq(e).text(u(this))}):f.find(".ui-slider-tooltip .ttContent").eq(0).text(u(v)),this};